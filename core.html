<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Minimal reprocution">

<title>Source Code – scholaris-minimal-reproduction-1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="Source Code – scholaris-minimal-reproduction-1">
<meta property="og:description" content="Minimal reprocution">
<meta property="og:site_name" content="scholaris-minimal-reproduction-1">
<meta name="twitter:title" content="Source Code – scholaris-minimal-reproduction-1">
<meta name="twitter:description" content="Minimal reprocution">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">scholaris-minimal-reproduction-1</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./core.html">Source Code</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">scholaris-minimal-reproduction-1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./core.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Source Code</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#helper-functions" id="toc-helper-functions" class="nav-link active" data-scroll-target="#helper-functions">Helper functions</a>
  <ul class="collapse">
  <li><a href="#generate_json_schema" id="toc-generate_json_schema" class="nav-link" data-scroll-target="#generate_json_schema">generate_json_schema</a></li>
  <li><a href="#json_schema_decorator" id="toc-json_schema_decorator" class="nav-link" data-scroll-target="#json_schema_decorator">json_schema_decorator</a></li>
  </ul></li>
  <li><a href="#local-file-processing-listing-content-extraction-and-summarization" id="toc-local-file-processing-listing-content-extraction-and-summarization" class="nav-link" data-scroll-target="#local-file-processing-listing-content-extraction-and-summarization">Local file processing: listing, content extraction, and summarization</a>
  <ul class="collapse">
  <li><a href="#get_file_names" id="toc-get_file_names" class="nav-link" data-scroll-target="#get_file_names">get_file_names</a></li>
  <li><a href="#extract_text_from_pdf" id="toc-extract_text_from_pdf" class="nav-link" data-scroll-target="#extract_text_from_pdf">extract_text_from_pdf</a></li>
  <li><a href="#extract_title_and_first_author" id="toc-extract_title_and_first_author" class="nav-link" data-scroll-target="#extract_title_and_first_author">extract_title_and_first_author</a></li>
  <li><a href="#get_titles_and_first_authors" id="toc-get_titles_and_first_authors" class="nav-link" data-scroll-target="#get_titles_and_first_authors">get_titles_and_first_authors</a></li>
  <li><a href="#summarize_local_document" id="toc-summarize_local_document" class="nav-link" data-scroll-target="#summarize_local_document">summarize_local_document</a></li>
  <li><a href="#describe_python_code" id="toc-describe_python_code" class="nav-link" data-scroll-target="#describe_python_code">describe_python_code</a></li>
  </ul></li>
  <li><a href="#external-data-retrieval-from-ncbi-openalex-and-semantic-scholar" id="toc-external-data-retrieval-from-ncbi-openalex-and-semantic-scholar" class="nav-link" data-scroll-target="#external-data-retrieval-from-ncbi-openalex-and-semantic-scholar">External data retrieval from NCBI, OpenAlex and Semantic Scholar</a>
  <ul class="collapse">
  <li><a href="#id_converter_tool" id="toc-id_converter_tool" class="nav-link" data-scroll-target="#id_converter_tool">id_converter_tool</a></li>
  <li><a href="#detect_id_type" id="toc-detect_id_type" class="nav-link" data-scroll-target="#detect_id_type">detect_id_type</a></li>
  <li><a href="#convert_id" id="toc-convert_id" class="nav-link" data-scroll-target="#convert_id">convert_id</a></li>
  <li><a href="#query_openalex_api" id="toc-query_openalex_api" class="nav-link" data-scroll-target="#query_openalex_api">query_openalex_api</a></li>
  <li><a href="#query_semantic_scholar_api" id="toc-query_semantic_scholar_api" class="nav-link" data-scroll-target="#query_semantic_scholar_api">query_semantic_scholar_api</a></li>
  <li><a href="#respond_to_generic_queries" id="toc-respond_to_generic_queries" class="nav-link" data-scroll-target="#respond_to_generic_queries">respond_to_generic_queries</a></li>
  </ul></li>
  <li><a href="#assistant-class" id="toc-assistant-class" class="nav-link" data-scroll-target="#assistant-class">Assistant class</a>
  <ul class="collapse">
  <li><a href="#show_response" id="toc-show_response" class="nav-link" data-scroll-target="#show_response">show_response</a></li>
  <li><a href="#assistant" id="toc-assistant" class="nav-link" data-scroll-target="#assistant">Assistant</a></li>
  <li><a href="#add_to_class" id="toc-add_to_class" class="nav-link" data-scroll-target="#add_to_class">add_to_class</a></li>
  <li><a href="#show_doc" id="toc-show_doc" class="nav-link" data-scroll-target="#show_doc">show_doc</a></li>
  <li><a href="#show_doc-1" id="toc-show_doc-1" class="nav-link" data-scroll-target="#show_doc-1">show_doc</a></li>
  <li><a href="#show_doc-2" id="toc-show_doc-2" class="nav-link" data-scroll-target="#show_doc-2">show_doc</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="core.html.md"><i class="bi bi-file-code"></i>CommonMark</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Source Code</h1>
</div>

<div>
  <div class="description">
    Minimal reprocution
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="helper-functions" class="level2">
<h2 class="anchored" data-anchor-id="helper-functions">Helper functions</h2>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L33" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="generate_json_schema" class="level3">
<h3 class="anchored" data-anchor-id="generate_json_schema">generate_json_schema</h3>
<blockquote class="blockquote">
<pre><code> generate_json_schema (func:Callable)</code></pre>
</blockquote>
<p>*Generate a JSON schema for the given function based on its annotations and docstring.</p>
<p>Args: func (Callable): The function to generate a schema for.</p>
<p>Returns: Dict[str, Any]: A JSON schema for the function.*</p>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L118" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="json_schema_decorator" class="level3">
<h3 class="anchored" data-anchor-id="json_schema_decorator">json_schema_decorator</h3>
<blockquote class="blockquote">
<pre><code> json_schema_decorator (func:~T)</code></pre>
</blockquote>
<p>*Decorator to generate and attach a JSON schema to a function.</p>
<p>Args: func (Callable): The function to decorate.</p>
<p>Returns: Callable: The decorated function with an attached JSON schema.*</p>
</section>
</section>
<section id="local-file-processing-listing-content-extraction-and-summarization" class="level2">
<h2 class="anchored" data-anchor-id="local-file-processing-listing-content-extraction-and-summarization">Local file processing: listing, content extraction, and summarization</h2>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L138" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="get_file_names" class="level3">
<h3 class="anchored" data-anchor-id="get_file_names">get_file_names</h3>
<blockquote class="blockquote">
<pre><code> get_file_names (ext:str='pdf, txt')</code></pre>
</blockquote>
<p>*Retrieves a list of file names with specified extensions in a local data directory the assistant has access to on the user’s computer.</p>
<p>Args: ext: A comma-separated string of file extensions to filter the files by. Options are: pdf, txt, md, markdown, csv, and py. Defaults to “pdf, txt”.</p>
<p>Returns: str: A comma-separated string of file names with the specified extensions. If no files are found, a message is returned.</p>
<p>Example: &gt;&gt;&gt; get_file_names(ext=“pdf, txt”)</p>
<pre><code>"List of file names with the specified extensions in the local data directory: file1.pdf, file2.txt"*</code></pre>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L187" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="extract_text_from_pdf" class="level3">
<h3 class="anchored" data-anchor-id="extract_text_from_pdf">extract_text_from_pdf</h3>
<blockquote class="blockquote">
<pre><code> extract_text_from_pdf (file_name:str, page_range:Optional[str]=None)</code></pre>
</blockquote>
<p>*A function that extracts text from a PDF file. Use this tool to extract specific details from a PDF document, such as abstract, authors, conclusions, or user-specified content of other sections. If the user specifies a page rage, use the optional page_range parameter to extract text from specific pages. If the user uses words such as beginning, middle, or end, to descripe the section, infer the page range based on the total number of 15 pages in a document. Do not use this tool to summarize an entire PDF document. Only use this tool for documents with extensions .pdf, or .PDF.</p>
<p>Args: file_name (str): The file name of the PDF document in the local data directory. page_range (Optional[str]): A string with page numbers and/or page ranges separated by commas (e.g., “1” or “1, 2”, or “5-7”). Default is None to extract all pages.</p>
<p>Returns: str: Extracted text from the PDF.</p>
<p>Example: &gt;&gt;&gt; text = extract_text_from_pdf(“./test.pdf”, page_range=“1”)*</p>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L278" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="extract_title_and_first_author" class="level3">
<h3 class="anchored" data-anchor-id="extract_title_and_first_author">extract_title_and_first_author</h3>
<blockquote class="blockquote">
<pre><code> extract_title_and_first_author (contents:List[Dict[str,str]],
                                 model:str='llama3.1',
                                 verbose:Optional[bool]=False,
                                 show_progress:Optional[bool]=False)</code></pre>
</blockquote>
<p>*A function that extracts the titles and the first author’s names from the text of one or more research articles.</p>
<p>Args: contents (List[Dict[str, str]]): A list of dictionaries containing the file name and extracted text. model (str): The model to use for the extraction. Default is ‘llama3.1’. verbose (Optional[bool]): Whether to print additional information. Default is False. show_progress (Optional[bool]): Whether to show a progress bar. Default is False.</p>
<p>Returns: contents (List[Dict[str, str]]): The input list of dictionaries with the extracted title and first author added.</p>
<p>Raises: JSONDecodeError: If the JSON response is invalid.</p>
<p>Example: &gt;&gt;&gt; contents = extract_title_and_first_author(contents) Extracting titles and first authors: 100%|██████████| 3/3 [00:22&lt;00:00, 7.35s/it]*</p>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L359" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_titles_and_first_authors" class="level3">
<h3 class="anchored" data-anchor-id="get_titles_and_first_authors">get_titles_and_first_authors</h3>
<blockquote class="blockquote">
<pre><code> get_titles_and_first_authors ()</code></pre>
</blockquote>
<p>*A function that retrieves the titles of research articles from a directory of PDF files.</p>
<p>Returns: str: A JSON-formatted string containing the titles, first authors and file names of the research articles.</p>
<p>Raises: FileNotFoundError: If the specified directory does not exist.</p>
<p>Example: &gt;&gt;&gt; get_titles_and_first_authors()*</p>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L413" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="summarize_local_document" class="level3">
<h3 class="anchored" data-anchor-id="summarize_local_document">summarize_local_document</h3>
<blockquote class="blockquote">
<pre><code> summarize_local_document (file_name:str, ext:str='pdf')</code></pre>
</blockquote>
<p>*Summarize the content of a single PDF, markdown, or text document from the local data directory.</p>
<p>Args: file_name (str): The file name of the local document to summarize. ext (str): The extension of the local document. Options are: pdf, txt, md, and markdown. Defaults to “pdf”.</p>
<p>Returns: str: The summary of the content of the local document.</p>
<p>Example: &gt;&gt;&gt; summarize_local_document(“research_paper”, ext=“pdf”)*</p>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L527" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="describe_python_code" class="level3">
<h3 class="anchored" data-anchor-id="describe_python_code">describe_python_code</h3>
<blockquote class="blockquote">
<pre><code> describe_python_code (file_name:str)</code></pre>
</blockquote>
<p>*Describe the purpose of the Python code in a local Python file. This may involve summarizing the entire code, extracting key functions, or providing an overview of the code structure.</p>
<p>Args: file_name (str): The file name of the local Python code file document to describe.</p>
<p>Returns: str: A description of the purpose of the Python code in the local file.</p>
<p>Example: &gt;&gt;&gt; describe_python_code(“main.py”, ext=“py”)*</p>
</section>
</section>
<section id="external-data-retrieval-from-ncbi-openalex-and-semantic-scholar" class="level2">
<h2 class="anchored" data-anchor-id="external-data-retrieval-from-ncbi-openalex-and-semantic-scholar">External data retrieval from NCBI, OpenAlex and Semantic Scholar</h2>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L682" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="id_converter_tool" class="level3">
<h3 class="anchored" data-anchor-id="id_converter_tool">id_converter_tool</h3>
<blockquote class="blockquote">
<pre><code> id_converter_tool (ids:List[str])</code></pre>
</blockquote>
<p>*For any article(s) in PubMed Central, find all the corresponding PubMed IDs (PMIDs), digital object identifiers (DOIs), and manuscript IDs (MIDs). Use this tool to convert a list of IDs, such as PMIDs, PMCIDs, or DOIs, and find the corresponding IDs for the same articles.</p>
<p>Args: ids (str): A string with a comma-separated list of IDs to convert. Must be PMIDs, PMCIDs, or DOIs. The maximum number of IDs per request is 200.</p>
<p>Returns: str: A JSON-formatted string containing the conversion results and the detected ID types.*</p>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L655" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="detect_id_type" class="level3">
<h3 class="anchored" data-anchor-id="detect_id_type">detect_id_type</h3>
<blockquote class="blockquote">
<pre><code> detect_id_type (id_string:str)</code></pre>
</blockquote>
<p>*Detect the type of the given ID or title.</p>
<p>Args: id_string (str): The ID or title to detect.</p>
<p>Returns: str: The detected type (‘pmid’, ‘pmcid’, ‘doi’, ‘openalex’, ‘semantic_scholar’, ‘potential_title’, or ‘unknown’).*</p>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L612" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="convert_id" class="level3">
<h3 class="anchored" data-anchor-id="convert_id">convert_id</h3>
<blockquote class="blockquote">
<pre><code> convert_id (ids:List[str])</code></pre>
</blockquote>
<p>*For any article(s) in PubMed Central, find all the corresponding PubMed IDs (PMIDs), digital object identifiers (DOIs), and manuscript IDs (MIDs).</p>
<p>Args: ids (List[str]): A list of IDs to convert (max 200 per request).</p>
<p>Returns: Str: A JSON-formatted string containing the conversion results.*</p>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L732" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="query_openalex_api" class="level3">
<h3 class="anchored" data-anchor-id="query_openalex_api">query_openalex_api</h3>
<blockquote class="blockquote">
<pre><code> query_openalex_api (query_param:str)</code></pre>
</blockquote>
<p>*Retrieve metadata for a given article from OpenAlex, a comprehensive open-access catalog of global research papers. Use this tool to search the OpenAlex API by using the article title, the PubMed ID (PMID), the PubMed Central ID (PMCID) or the digital object identifier (DOI) of an article as the query parameter. This tool returns the following metadata: - the OpenAlex ID - the digital object identifier (DOI) URL - Citation count - The open access status - URL to the open-access location for the work - Publication year - A URL to a website listing works that have cite the article - The type of the article Use this tool only if an article title, PubMed ID or DOI is provided by the user or was extracted from a local PDF file and is present in the conversation history.</p>
<p>Args: query_param (str): The article title, the PubMed ID (PMID), the PubMed Central ID (PMCID) or the digital object identifier (DOI) of the article to retrieve metadata for. May be provided by the user or extracted from a local PDF file and present in the conversation history.</p>
<p>Returns: str: A JSON-formatted string including the search results from the OpenAlex database. If no results are found or the API query fails, an appropriate message is returned.*</p>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L826" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="query_semantic_scholar_api" class="level3">
<h3 class="anchored" data-anchor-id="query_semantic_scholar_api">query_semantic_scholar_api</h3>
<blockquote class="blockquote">
<pre><code> query_semantic_scholar_api (query_param:str)</code></pre>
</blockquote>
<p>*Retrieve metadata for a given article from the Semantic Scholar Academic Graph (S2AG), a large knowledge graph of scientific literature that combines data from multiple sources. Use this tool to query the Semantic Scholar Graph API by using either the article title, the PubMed ID, or the digital object identifier (DOI) to retrieve the following metadata: - the title - the publication year - the abstract - a tldr (too long, didn’t read) summary - the authors of the article - the URL to the open-access PDF version of the article, if available - the journal name - a url to the article on the Semantic Scholar website Use this tool only if an article title, PubMed ID or DOI is provided by the user or was extracted from a local PDF file and is present in the conversation history.</p>
<p>Args: query_param (str): The article title, the PubMed ID, or the digital object identifier of the article to retrieve metadata for. May be provided by the user or extracted from a local PDF file and present in the conversation history. Do not include the ‘https://doi.org/’ prefix for DOIs, or keys such as ‘DOI’, ‘PMCID’ or ‘PMID’. The tool will automatically detect the type of identifier provided.</p>
<p>Returns: str: A JSON-formatted string including the search results from the Semantic Scholar database. If no results are found or the API query fails, an appropriate message is returned.*</p>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L903" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="respond_to_generic_queries" class="level3">
<h3 class="anchored" data-anchor-id="respond_to_generic_queries">respond_to_generic_queries</h3>
<blockquote class="blockquote">
<pre><code> respond_to_generic_queries ()</code></pre>
</blockquote>
<p>*A function to respond to generic questions or queries from the user. Use this tool if no better tool is available.</p>
<p>This tool does not take any arguments.</p>
<p>Returns: str: A response to a generic question.*</p>
</section>
</section>
<section id="assistant-class" class="level2">
<h2 class="anchored" data-anchor-id="assistant-class">Assistant class</h2>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L916" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="show_response" class="level3">
<h3 class="anchored" data-anchor-id="show_response">show_response</h3>
<blockquote class="blockquote">
<pre><code> show_response (response:Dict[str,Any])</code></pre>
</blockquote>
<p>*Print the response from the LLM in a human-readable format.</p>
<p>Args: response (Dict[str, Any] or Generator[Dict[str, Any], None, None]): The response from the LLM.*</p>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L948" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="assistant" class="level3">
<h3 class="anchored" data-anchor-id="assistant">Assistant</h3>
<blockquote class="blockquote">
<pre><code> Assistant (status:dict={}, sys_message:str=None,
            model:str='llama3.1:latest',
            tools:Dict[str,Any]={'get_file_names': &lt;function
            get_file_names at 0x7f28b807dbd0&gt;, 'extract_text_from_pdf':
            &lt;function extract_text_from_pdf at 0x7f28b8c796c0&gt;,
            'get_titles_and_first_authors': &lt;function
            get_titles_and_first_authors at 0x7f28b7ef15a0&gt;,
            'summarize_local_document': &lt;function summarize_local_document
            at 0x7f28b7ef2050&gt;, 'describe_python_code': &lt;function
            describe_python_code at 0x7f28b7ef2560&gt;, 'id_converter_tool':
            &lt;function id_converter_tool at 0x7f28b7ef2e60&gt;,
            'query_openalex_api': &lt;function query_openalex_api at
            0x7f28b7ef2ef0&gt;, 'query_semantic_scholar_api': &lt;function
            query_semantic_scholar_api at 0x7f28b7ef35b0&gt;,
            'respond_to_generic_queries': &lt;function
            respond_to_generic_queries at 0x7f28b7ef3880&gt;},
            add_tools:Dict[str,Any]={},
            authentication:Optional[Dict[str,str]]=None,
            dir_path:str='../data', messages:List[Dict[str,str]]=[])</code></pre>
</blockquote>
<p><em>Initialize self. See help(type(self)) for accurate signature.</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>status</td>
<td>dict</td>
<td>{}</td>
<td>The status of the assistant</td>
</tr>
<tr class="even">
<td>sys_message</td>
<td>str</td>
<td>None</td>
<td>The system message for the assistant; if not provided, a default message is used</td>
</tr>
<tr class="odd">
<td>model</td>
<td>str</td>
<td>llama3.1:latest</td>
<td>The model to use for the assistant</td>
</tr>
<tr class="even">
<td>tools</td>
<td>Dict</td>
<td>{‘get_file_names’: &lt;function get_file_names at 0x7f28b807dbd0&gt;, ‘extract_text_from_pdf’: &lt;function extract_text_from_pdf at 0x7f28b8c796c0&gt;, ‘get_titles_and_first_authors’: &lt;function get_titles_and_first_authors at 0x7f28b7ef15a0&gt;, ‘summarize_local_document’: &lt;function summarize_local_document at 0x7f28b7ef2050&gt;, ‘describe_python_code’: &lt;function describe_python_code at 0x7f28b7ef2560&gt;, ‘id_converter_tool’: &lt;function id_converter_tool at 0x7f28b7ef2e60&gt;, ‘query_openalex_api’: &lt;function query_openalex_api at 0x7f28b7ef2ef0&gt;, ‘query_semantic_scholar_api’: &lt;function query_semantic_scholar_api at 0x7f28b7ef35b0&gt;, ‘respond_to_generic_queries’: &lt;function respond_to_generic_queries at 0x7f28b7ef3880&gt;}</td>
<td>The tools available to the assistant</td>
</tr>
<tr class="odd">
<td>add_tools</td>
<td>Dict</td>
<td>{}</td>
<td>Optional argument to add additional tools to the assistant, when initializing</td>
</tr>
<tr class="even">
<td>authentication</td>
<td>Optional</td>
<td>None</td>
<td>Authentication credentials for API calls to external services</td>
</tr>
<tr class="odd">
<td>dir_path</td>
<td>str</td>
<td>../data</td>
<td>The directory path to which the assistant has access on the local computer</td>
</tr>
<tr class="even">
<td>messages</td>
<td>List</td>
<td>[]</td>
<td>The conversation history</td>
</tr>
</tbody>
</table>
<div id="cell-22" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>assistant <span class="op">=</span> Assistant()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loaded Semantic Scholar API key from the environment variables.
Loaded email address from the environment variables.
A local directory /Users/user2/GitHub/scholaris-minimal-reproduction-1/data already exists for storing data files. No of files: 0
</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/blob/main/scholaris_minimal_reproduction_1/core.py#L1228" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="add_to_class" class="level3">
<h3 class="anchored" data-anchor-id="add_to_class">add_to_class</h3>
<blockquote class="blockquote">
<pre><code> add_to_class (Class:type)</code></pre>
</blockquote>
<p><em>Register functions as methods in a class that has already been defined.</em></p>
<hr>
<p><a href="https://github.com/fastai/nbdev/blob/master/nbdev/showdoc.py#LNone" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="show_doc" class="level3">
<h3 class="anchored" data-anchor-id="show_doc">show_doc</h3>
<blockquote class="blockquote">
<pre><code> show_doc (sym, renderer=None, name:str|None=None, title_level:int=3)</code></pre>
</blockquote>
<p><em>Show signature and docstring for <code>sym</code></em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sym</td>
<td></td>
<td></td>
<td>Symbol to document</td>
</tr>
<tr class="even">
<td>renderer</td>
<td>NoneType</td>
<td>None</td>
<td>Optional renderer (defaults to markdown)</td>
</tr>
<tr class="odd">
<td>name</td>
<td>str | None</td>
<td>None</td>
<td>Optionally override displayed name of <code>sym</code></td>
</tr>
<tr class="even">
<td>title_level</td>
<td>int</td>
<td>3</td>
<td>Heading level to use for symbol name</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/fastai/nbdev/blob/master/nbdev/showdoc.py#LNone" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="show_doc-1" class="level3">
<h3 class="anchored" data-anchor-id="show_doc-1">show_doc</h3>
<blockquote class="blockquote">
<pre><code> show_doc (sym, renderer=None, name:str|None=None, title_level:int=3)</code></pre>
</blockquote>
<p><em>Show signature and docstring for <code>sym</code></em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sym</td>
<td></td>
<td></td>
<td>Symbol to document</td>
</tr>
<tr class="even">
<td>renderer</td>
<td>NoneType</td>
<td>None</td>
<td>Optional renderer (defaults to markdown)</td>
</tr>
<tr class="odd">
<td>name</td>
<td>str | None</td>
<td>None</td>
<td>Optionally override displayed name of <code>sym</code></td>
</tr>
<tr class="even">
<td>title_level</td>
<td>int</td>
<td>3</td>
<td>Heading level to use for symbol name</td>
</tr>
</tbody>
</table>
<hr>
<p><a href="https://github.com/fastai/nbdev/blob/master/nbdev/showdoc.py#LNone" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="show_doc-2" class="level3">
<h3 class="anchored" data-anchor-id="show_doc-2">show_doc</h3>
<blockquote class="blockquote">
<pre><code> show_doc (sym, renderer=None, name:str|None=None, title_level:int=3)</code></pre>
</blockquote>
<p><em>Show signature and docstring for <code>sym</code></em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>sym</td>
<td></td>
<td></td>
<td>Symbol to document</td>
</tr>
<tr class="even">
<td>renderer</td>
<td>NoneType</td>
<td>None</td>
<td>Optional renderer (defaults to markdown)</td>
</tr>
<tr class="odd">
<td>name</td>
<td>str | None</td>
<td>None</td>
<td>Optionally override displayed name of <code>sym</code></td>
</tr>
<tr class="even">
<td>title_level</td>
<td>int</td>
<td>3</td>
<td>Heading level to use for symbol name</td>
</tr>
</tbody>
</table>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/nicomarr\.github\.io\/scholaris-minimal-reproduction-1");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/nicomarr/scholaris-minimal-reproduction-1/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>